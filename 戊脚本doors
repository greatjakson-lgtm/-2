-- 主 GUI
local ScreenGui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
ScreenGui.Name = "BigUI"

local MainFrame = Instance.new("Frame", ScreenGui)
MainFrame.Size = UDim2.new(0, 650, 0, 420)
MainFrame.Position = UDim2.new(0.5, -325, 0.5, -210)
MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
MainFrame.Active = true
MainFrame.Draggable = true

local UICorner = Instance.new("UICorner", MainFrame)
UICorner.CornerRadius = UDim.new(0, 12)

-- 标签栏
local TabBar = Instance.new("Frame", MainFrame)
TabBar.Size = UDim2.new(1, 0, 0, 40)
TabBar.BackgroundColor3 = Color3.fromRGB(40, 40, 40)

local TabLayout = Instance.new("UIListLayout", TabBar)
TabLayout.FillDirection = Enum.FillDirection.Horizontal
TabLayout.SortOrder = Enum.SortOrder.LayoutOrder
TabLayout.Padding = UDim.new(0, 5)

-- 内容容器
local ContentFrame = Instance.new("Frame", MainFrame)
ContentFrame.Size = UDim2.new(1, -10, 1, -50)
ContentFrame.Position = UDim2.new(0, 5, 0, 45)
ContentFrame.BackgroundTransparency = 1

local Pages = {}

-- ========== 标签页 ==========
local function createTab(name)
    local button = Instance.new("TextButton", TabBar)
    button.Size = UDim2.new(0, 120, 1, 0)
    button.Text = name
    button.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    button.TextColor3 = Color3.fromRGB(255, 255, 255)
    button.Font = Enum.Font.SourceSansBold
    button.TextSize = 18
    button.AutoButtonColor = true

    local corner = Instance.new("UICorner", button)
    corner.CornerRadius = UDim.new(0, 8)

    local page = Instance.new("Frame", ContentFrame)
    page.Size = UDim2.new(1, 0, 1, 0)
    page.BackgroundTransparency = 1
    page.Visible = false

    Pages[name] = page

    button.MouseButton1Click:Connect(function()
        for _, p in pairs(Pages) do p.Visible = false end
        page.Visible = true
    end)

    return page
end

-- ========== 子菜单 ==========
local function createSection(parent, title)
    local section = Instance.new("Frame", parent)
    section.Size = UDim2.new(1, 0, 0, 40)
    section.BackgroundColor3 = Color3.fromRGB(35, 35, 35)

    local header = Instance.new("TextButton", section)
    header.Size = UDim2.new(1, 0, 0, 40)
    header.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
    header.TextColor3 = Color3.fromRGB(255, 255, 255)
    header.Font = Enum.Font.SourceSansBold
    header.TextSize = 18
    header.Text = "▼ " .. title
    header.AutoButtonColor = false

    local corner = Instance.new("UICorner", header)
    corner.CornerRadius = UDim.new(0, 8)

    local content = Instance.new("Frame", section)
    content.Size = UDim2.new(1, 0, 0, 0)
    content.Position = UDim2.new(0, 0, 0, 40)
    content.BackgroundTransparency = 1
    content.ClipsDescendants = true

    local layout = Instance.new("UIListLayout", content)
    layout.SortOrder = Enum.SortOrder.LayoutOrder
    layout.Padding = UDim.new(0, 6)

    local expanded = false
    local function updateHeight()
        if expanded then
            section.Size = UDim2.new(1, 0, 0, 40 + content.UIListLayout.AbsoluteContentSize.Y + 12)
            content.Size = UDim2.new(1, 0, 0, content.UIListLayout.AbsoluteContentSize.Y + 12)
        else
            section.Size = UDim2.new(1, 0, 0, 40)
            content.Size = UDim2.new(1, 0, 0, 0)
        end
    end

    layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(updateHeight)

    header.MouseButton1Click:Connect(function()
        expanded = not expanded
        header.Text = (expanded and "▲ " or "▼ ") .. title
        updateHeight()
    end)

    return content, updateHeight
end

-- ========== 美观控件 ==========
local function createSwitch(parent, text)
    local frame = Instance.new("Frame", parent)
    frame.Size = UDim2.new(1, 0, 0, 35)
    frame.BackgroundTransparency = 1

    local label = Instance.new("TextLabel", frame)
    label.Size = UDim2.new(0.7, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.Text = text
    label.Font = Enum.Font.SourceSans
    label.TextSize = 18

    local button = Instance.new("TextButton", frame)
    button.Size = UDim2.new(0, 50, 0, 25)
    button.Position = UDim2.new(0.75, 0, 0.1, 0)
    button.BackgroundColor3 = Color3.fromRGB(120, 120, 120)
    button.Text = ""
    button.AutoButtonColor = false

    local corner = Instance.new("UICorner", button)
    corner.CornerRadius = UDim.new(1, 0)

    local on = false
    button.MouseButton1Click:Connect(function()
        on = not on
        button.BackgroundColor3 = on and Color3.fromRGB(0, 200, 100) or Color3.fromRGB(120, 120, 120)
    end)
end

local function createSlider(parent, text, min, max, default)
    local frame = Instance.new("Frame", parent)
    frame.Size = UDim2.new(1, 0, 0, 40)
    frame.BackgroundTransparency = 1

    local label = Instance.new("TextLabel", frame)
    label.Size = UDim2.new(1, 0, 0.5, 0)
    label.BackgroundTransparency = 1
    label.TextColor3 = Color3.fromRGB(255,255,255)
    label.Text = text .. ": " .. default
    label.Font = Enum.Font.SourceSans
    label.TextSize = 16

    local bar = Instance.new("Frame", frame)
    bar.Size = UDim2.new(1, -20, 0, 6)
    bar.Position = UDim2.new(0, 10, 0.7, 0)
    bar.BackgroundColor3 = Color3.fromRGB(80, 80, 80)

    local fill = Instance.new("Frame", bar)
    fill.Size = UDim2.new((default-min)/(max-min), 0, 1, 0)
    fill.BackgroundColor3 = Color3.fromRGB(0, 170, 255)

    local dragging = false

    bar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
        end
    end)

    bar.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)

    game:GetService("UserInputService").InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local pos = math.clamp((input.Position.X - bar.AbsolutePosition.X)/bar.AbsoluteSize.X, 0, 1)
            fill.Size = UDim2.new(pos, 0, 1, 0)
            local value = math.floor(min + (max-min)*pos)
            label.Text = text .. ": " .. value
        end
    end)
end

local function createDropdown(parent, text, options)
    local frame = Instance.new("Frame", parent)
    frame.Size = UDim2.new(1, 0, 0, 35)
    frame.BackgroundTransparency = 1

    local button = Instance.new("TextButton", frame)
    button.Size = UDim2.new(1, 0, 1, 0)
    button.BackgroundColor3 = Color3.fromRGB(70,70,70)
    button.TextColor3 = Color3.fromRGB(255,255,255)
    button.Text = text .. ": ▼"
    button.Font = Enum.Font.SourceSans
    button.TextSize = 18

    local corner = Instance.new("UICorner", button)
    corner.CornerRadius = UDim.new(0, 6)

    local listFrame = Instance.new("Frame", frame)
    listFrame.Size = UDim2.new(1, 0, 0, 0)
    listFrame.Position = UDim2.new(0,0,1,0)
    listFrame.BackgroundColor3 = Color3.fromRGB(50,50,50)
    listFrame.ClipsDescendants = true
    listFrame.Visible = false

    local layout = Instance.new("UIListLayout", listFrame)
    layout.SortOrder = Enum.SortOrder.LayoutOrder

    local expanded = false
    button.MouseButton1Click:Connect(function()
        expanded = not expanded
        listFrame.Visible = expanded
        listFrame.Size = expanded and UDim2.new(1,0,0,#options*30) or UDim2.new(1,0,0,0)
    end)

    for _,opt in ipairs(options) do
        local optBtn = Instance.new("TextButton", listFrame)
        optBtn.Size = UDim2.new(1,0,0,30)
        optBtn.Text = opt
        optBtn.BackgroundColor3 = Color3.fromRGB(60,60,60)
        optBtn.TextColor3 = Color3.fromRGB(255,255,255)

        optBtn.MouseButton1Click:Connect(function()
            button.Text = text..": "..opt
            expanded = false
            listFrame.Visible = false
            listFrame.Size = UDim2.new(1,0,0,0)
        end)
    end
end

-- ========== 标签页示例 ==========
local espPage = createTab("透视")
local speedPage = createTab("速度")
local autoPage = createTab("自动互动")
local configPage = createTab("配置")
local uiPage = createTab("UI设置")

Pages["透视"].Visible = true

-- 透视
local distSec = createSection(espPage, "距离设置")
createSlider(distSec, "金币", 0, 500, 50)
createSlider(distSec, "玩家", 0, 500, 200)

local colorSec = createSection(espPage, "颜色设置")
createDropdown(colorSec, "金币颜色", {"黄色","橙色"})
createDropdown(colorSec, "玩家颜色", {"蓝色","绿色"})

-- 速度
local spdSec = createSection(speedPage, "速度设置")
createSlider(spdSec, "移动速度", 1, 200, 16)

-- 自动互动
local autoSec = createSection(autoPage, "自动互动")
createSwitch(autoSec, "自动拾取金币")
createSwitch(autoSec, "自动拾取物品")
createSwitch(autoSec, "自动开箱子")

-- 配置
local cfgSec = createSection(configPage, "配置管理")
createDropdown(cfgSec, "默认配置", {"配置1","配置2"})
createSwitch(cfgSec, "一键重置")

-- UI设置
local uiSec = createSection(uiPage, "界面设置")
createDropdown(uiSec, "主题", {"暗色","亮色"})
createSlider(uiSec, "缩放", 80, 150, 100)
